---
export const prerender = true;

import { getCollection } from "astro:content";
import { getPostSlug } from "./posts/[...blogId].astro";

const posts = await getCollection("posts");
const streamingPosts = posts
  .filter((post) => post.data.tags.includes("streaming schedule"))
  .sort((a, b) => b.data.created_at.getTime() - a.data.created_at.getTime());

const latestPost = streamingPosts[0];
if (!latestPost) {
  return Astro.redirect("/posts", 302);
}

const slug = getPostSlug(latestPost);
return Astro.redirect(`/posts/${slug}`, 301);
---
