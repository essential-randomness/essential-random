---
import { getCollection, getEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((project) => ({
    params: {
      blogId: project.slug,
    },
  }));
}
const { blogId } = Astro.params;
if (!blogId) {
  throw new Error("Slug is required");
}
const curr = await getEntry("posts", blogId);
if (!curr) {
  throw new Error("Post not found");
}
const Content = (await curr?.render()).Content;
---

<Layout title="Essential Randomness â€” Ms Boba's Emporium of Weirdness">
  <main class="post">
    <h1>
      {curr.data.title}
    </h1>
    <h2 id="table-of-contents">Table of Contents</h2>
    <Content />
  </main>

  <style is:global>
    figure {
      max-width: 100%;
      max-height: 900px;
      height: auto;
      width: auto;
      margin: 0 auto;
      display: block;

      :not(&) > img {
        padding-block: 1.5rem;
      }

      p {
        margin: 0;
        font-size: smaller;
      }
      figcaption p {
        padding-inline: min(3rem, 5%);
        text-align: center;
      }
    }

    #table-of-contents + nav > ol {
      border: 2px solid black;
      border-radius: 16px;
      padding: 30px 50px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      height: 100%;
      box-shadow: var(--box-shadow-deep);
      margin-bottom: 50px;

      li {
        margin-bottom: 0;
        display: flex;
        flex-direction: column;
        gap: 5px;

        ol {
          padding-inline-start: 20px;
        }
      }
    }

    img {
      max-width: 100%;
      max-height: 900px;
      height: auto;
      width: auto;
      margin: 0 auto;
      display: block;
    }

    .custom-emoji {
      display: inline-block;
      padding: 0 5px;
      height: 30px;
      vertical-align: middle;

      & + .custom-emoji {
        padding-inline-start: 0;
      }
    }
  </style>
</Layout>
